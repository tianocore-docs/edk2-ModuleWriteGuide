
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>8.4 Communication between DXE Drivers Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
        <link rel="stylesheet" href="../styles/website.css">
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="85_communication_with_peims.html" />
    
    
    <link rel="prev" href="83_obtaining_services_tables.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../#edk-ii-module-writers-guide">
            
                    
                    EDK II Module Writer's Guide
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../TABLES.html">
            
                <a href="../TABLES.html#tables">
            
                    
                    Tables
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../FIGURES.html">
            
                <a href="../FIGURES.html#figures">
            
                    
                    Figures
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../1_the_basics_of_edk_ii/">
            
                <a href="../1_the_basics_of_edk_ii/#1-the-basics-of-edk-ii">
            
                    
                    1 The Basics of EDK II
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../1_the_basics_of_edk_ii/11_overview.html">
            
                <a href="../1_the_basics_of_edk_ii/11_overview.html#11-overview">
            
                    
                    1.1 Overview
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../1_the_basics_of_edk_ii/12_related_references.html">
            
                <a href="../1_the_basics_of_edk_ii/12_related_references.html#12-related-references">
            
                    
                    1.2 Related References
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../1_the_basics_of_edk_ii/13_terms.html">
            
                <a href="../1_the_basics_of_edk_ii/13_terms.html#13-terms">
            
                    
                    1.3 Terms
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="../1_the_basics_of_edk_ii/14_target_audience.html">
            
                <a href="../1_the_basics_of_edk_ii/14_target_audience.html#14-target-audience">
            
                    
                    1.4 Target Audience
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../2_an_edk_ii_package/">
            
                <a href="../2_an_edk_ii_package/#2-an-edk-ii-package">
            
                    
                    2 An EDK II Package
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../2_an_edk_ii_package/21_introduction.html">
            
                <a href="../2_an_edk_ii_package/21_introduction.html#21-introduction">
            
                    
                    2.1 Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../2_an_edk_ii_package/22_manage_package.html">
            
                <a href="../2_an_edk_ii_package/22_manage_package.html#22-manage-package">
            
                    
                    2.2 Manage Package
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../3_module_development/">
            
                <a href="../3_module_development/#3-module-development">
            
                    
                    3 Module Development
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../3_module_development/31_what_is_an_edk_ii_module.html">
            
                <a href="../3_module_development/31_what_is_an_edk_ii_module.html#31-what-is-an-edk-ii-module">
            
                    
                    3.1 What is an EDK II module?
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../3_module_development/32_creating_a_module.html">
            
                <a href="../3_module_development/32_creating_a_module.html#32-creating-a-module">
            
                    
                    3.2 Creating a Module
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="../3_module_development/33_additional_steps_for_library_instances.html">
            
                <a href="../3_module_development/33_additional_steps_for_library_instances.html#33-additional-steps-for-library-instances">
            
                    
                    3.3 Additional Steps for Library Instances
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4" data-path="../3_module_development/34_additional_steps_for_driver.html">
            
                <a href="../3_module_development/34_additional_steps_for_driver.html#34-additional-steps-for-driver">
            
                    
                    3.4 Additional Steps for Driver
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.5" data-path="../3_module_development/35_edk_ii_common_library_class.html">
            
                <a href="../3_module_development/35_edk_ii_common_library_class.html#35-edk-ii-common-library-class">
            
                    
                    3.5 EDK II Common Library Class
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.6" data-path="../3_module_development/36_module_using_hii.html">
            
                <a href="../3_module_development/36_module_using_hii.html#36-module-using-hii">
            
                    
                    3.6 Module using HII
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.7" data-path="../3_module_development/37_building_the_module.html">
            
                <a href="../3_module_development/37_building_the_module.html#37-building-the-module">
            
                    
                    3.7 Building the module
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.8" data-path="../3_module_development/38_debugging_a_module.html">
            
                <a href="../3_module_development/38_debugging_a_module.html#38-debugging-a-module">
            
                    
                    3.8 Debugging a Module
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../4_uefi_applications/">
            
                <a href="../4_uefi_applications/#4-uefi-applications">
            
                    
                    4 UEFI Applications
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="../4_uefi_applications/41_begin_with_inf_file.html">
            
                <a href="../4_uefi_applications/41_begin_with_inf_file.html#41-begin-with-inf-file">
            
                    
                    4.1 Begin with INF file
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="../4_uefi_applications/42_write_uefi_application_entry_point.html">
            
                <a href="../4_uefi_applications/42_write_uefi_application_entry_point.html#42-write-uefi-application-entry-point">
            
                    
                    4.2 Write UEFI Application Entry Point
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.3" data-path="../4_uefi_applications/43_get_service_tables.html">
            
                <a href="../4_uefi_applications/43_get_service_tables.html#43-get-service-tables">
            
                    
                    4.3 Get Service Tables
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.4" data-path="../4_uefi_applications/44_communicating_with_a_uefi_driver.html">
            
                <a href="../4_uefi_applications/44_communicating_with_a_uefi_driver.html#44-communicating-with-a-uefi-driver">
            
                    
                    4.4 Communicating with a UEFI driver
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../5_uefi_drivers/">
            
                <a href="../5_uefi_drivers/#5-uefi-drivers">
            
                    
                    5 UEFI Drivers
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="../5_uefi_drivers/51_begin_with_inf_file.html">
            
                <a href="../5_uefi_drivers/51_begin_with_inf_file.html#51-begin-with-inf-file">
            
                    
                    5.1 Begin With INF File
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2" data-path="../5_uefi_drivers/52_write_the_uefi_driver_entry_point.html">
            
                <a href="../5_uefi_drivers/52_write_the_uefi_driver_entry_point.html#52-write-the-uefi-driver-entry-point">
            
                    
                    5.2 Write the UEFI Driver entry point
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3" data-path="../5_uefi_drivers/53_get_service_tables.html">
            
                <a href="../5_uefi_drivers/53_get_service_tables.html#53-get-service-tables">
            
                    
                    5.3 Get Service Tables
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.4" data-path="../5_uefi_drivers/54_communication_between_uefi_drivers.html">
            
                <a href="../5_uefi_drivers/54_communication_between_uefi_drivers.html#54-communication-between-uefi-drivers">
            
                    
                    5.4 Communication between UEFI Drivers
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../6_sec_module/">
            
                <a href="../6_sec_module/#6-sec-module">
            
                    
                    6 SEC Module
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1" data-path="../6_sec_module/61_beginning_to_write_the_inf_file.html">
            
                <a href="../6_sec_module/61_beginning_to_write_the_inf_file.html#61-beginning-to-write-the-inf-file">
            
                    
                    6.1 Beginning to Write the INF File
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2" data-path="../6_sec_module/62_setup_pre-memory_environment.html">
            
                <a href="../6_sec_module/62_setup_pre-memory_environment.html#62-setup-pre-memory-environment">
            
                    
                    6.2 Setup Pre-Memory Environment
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.3" data-path="../6_sec_module/63_prepare_for_data_pei_foundation.html">
            
                <a href="../6_sec_module/63_prepare_for_data_pei_foundation.html#63-prepare-for-data-pei-foundation">
            
                    
                    6.3 Prepare for Data PEI Foundation
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="../7_pre-efi_initialization_modules/">
            
                <a href="../7_pre-efi_initialization_modules/#7-pre-efi-initialization-modules">
            
                    
                    7 Pre-EFI Initialization Modules
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.1" data-path="../7_pre-efi_initialization_modules/71_introduction.html">
            
                <a href="../7_pre-efi_initialization_modules/71_introduction.html#71-introduction">
            
                    
                    7.1 Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.2" data-path="../7_pre-efi_initialization_modules/72_beginning_to_write_a_peim_inf_file.html">
            
                <a href="../7_pre-efi_initialization_modules/72_beginning_to_write_a_peim_inf_file.html#72-beginning-to-write-a-peim-inf-file">
            
                    
                    7.2 Beginning to Write a PEIM INF File
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.3" data-path="../7_pre-efi_initialization_modules/73_defining_a_peims_entry_point.html">
            
                <a href="../7_pre-efi_initialization_modules/73_defining_a_peims_entry_point.html#73-defining-a-peims-entry-point">
            
                    
                    7.3 Defining a PEIM's entry point
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.4" data-path="../7_pre-efi_initialization_modules/74_get_pei_services.html">
            
                <a href="../7_pre-efi_initialization_modules/74_get_pei_services.html#74-get-pei-services">
            
                    
                    7.4 Get Pei Services
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.5" data-path="../7_pre-efi_initialization_modules/75_communicate_between_peim_modules.html">
            
                <a href="../7_pre-efi_initialization_modules/75_communicate_between_peim_modules.html#75-communicate-between-peim-modules">
            
                    
                    7.5 Communicate between PEIM Modules
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.6" data-path="../7_pre-efi_initialization_modules/76_communicate_with_dxe_modules.html">
            
                <a href="../7_pre-efi_initialization_modules/76_communicate_with_dxe_modules.html#76-communicate-with-dxe-modules">
            
                    
                    7.6 Communicate with DXE Modules
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.7" data-path="../7_pre-efi_initialization_modules/77_boot_mode.html">
            
                <a href="../7_pre-efi_initialization_modules/77_boot_mode.html#77-boot-mode">
            
                    
                    7.7 Boot Mode
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.8" data-path="../7_pre-efi_initialization_modules/78_execution_in_place_peims.html">
            
                <a href="../7_pre-efi_initialization_modules/78_execution_in_place_peims.html#78-execution-in-place-peims">
            
                    
                    7.8 Execution in Place PEIMs
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.9" data-path="../7_pre-efi_initialization_modules/79_dependency_for_peims.html">
            
                <a href="../7_pre-efi_initialization_modules/79_dependency_for_peims.html#79-dependency-for-peims">
            
                    
                    7.9 Dependency for PEIMs
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="./">
            
                <a href="./#8-dxe-drivers-non-uefi-drivers">
            
                    
                    8 DXE Drivers: non-UEFI drivers
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.11.1" data-path="81_beginning_with_inf_file.html">
            
                <a href="81_beginning_with_inf_file.html#81-beginning-with-inf-file">
            
                    
                    8.1 Beginning with INF File
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.2" data-path="82_write_dxe_driver_entry_point.html">
            
                <a href="82_write_dxe_driver_entry_point.html#82-write-dxe-driver-entry-point">
            
                    
                    8.2 Write DXE Driver Entry Point
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.3" data-path="83_obtaining_services_tables.html">
            
                <a href="83_obtaining_services_tables.html#83-obtaining-services-tables">
            
                    
                    8.3 Obtaining Services Tables
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.4" data-path="84_communication_between_dxe_drivers.html">
            
                <a href="84_communication_between_dxe_drivers.html#84-communication-between-dxe-drivers">
            
                    
                    8.4 Communication between DXE Drivers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.5" data-path="85_communication_with_peims.html">
            
                <a href="85_communication_with_peims.html#85-communication-with-peims">
            
                    
                    8.5 Communication with PEIMs
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.6" data-path="86_dependency_expressions.html">
            
                <a href="86_dependency_expressions.html#86-dependency-expressions">
            
                    
                    8.6 Dependency Expressions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.7" data-path="87_handler_for_evtsignal_exit_boot_services.html">
            
                <a href="87_handler_for_evtsignal_exit_boot_services.html#87-handler-for-evt_signal_exit_boot_services">
            
                    
                    8.7 Handler for EVT_SIGNAL_EXIT_BOOT_SERVICES
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.8" data-path="88_dxe_runtime_driver.html">
            
                <a href="88_dxe_runtime_driver.html#88-dxe-runtime-driver">
            
                    
                    8.8 DXE Runtime Driver
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.9" data-path="89_dxe_sal_driver.html">
            
                <a href="89_dxe_sal_driver.html#89-dxe-sal-driver">
            
                    
                    8.9 DXE SAL Driver
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.10" data-path="810_dxe_smm_driver.html">
            
                <a href="810_dxe_smm_driver.html#810-dxe-smm-driver">
            
                    
                    8.10 DXE SMM Driver
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12" data-path="../appendix_a_dynamic_pcd.html">
            
                <a href="../appendix_a_dynamic_pcd.html#appendix-a-dynamic-pcd">
            
                    
                    Appendix A Dynamic PCD
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >8.4 Communication between DXE Drivers</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <!--- @file
  8.4 Communication between DXE Drivers

  Copyright (c) 2010-2018, Intel Corporation. All rights reserved.<BR>

  Redistribution and use in source (original document form) and 'compiled'
  forms (converted to PDF, epub, HTML and other formats) with or without
  modification, are permitted provided that the following conditions are met:

  1) Redistributions of source code (original document form) must retain the
     above copyright notice, this list of conditions and the following
     disclaimer as the first lines of this file unmodified.

  2) Redistributions in compiled form (transformed to other DTDs, converted to
     PDF, epub, HTML and other formats) must reproduce the above copyright
     notice, this list of conditions and the following disclaimer in the
     documentation and/or other materials provided with the distribution.

  THIS DOCUMENTATION IS PROVIDED BY TIANOCORE PROJECT "AS IS" AND ANY EXPRESS OR
  IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
  MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO
  EVENT SHALL TIANOCORE PROJECT  BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
  SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;
  OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR
  OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS DOCUMENTATION, EVEN IF
  ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

-->
<h2 id="84-communication-between-dxe-drivers">8.4 Communication between DXE Drivers</h2>
<p>This section introduces communication channels between DXE drivers, including
protocol, variable, and PCD.</p>
<h3 id="841-protocol">8.4.1 Protocol</h3>
<p>This section will introduce how to produce and consume protocols. The <em>UEFI
Specification</em> defines a group of boot services to handle protocols, including:</p>
<p>Services to install protocols</p>
<ul>
<li><p><code>InstallProtocolInterface()</code></p>
</li>
<li><p><code>ReInstallProtocolInterface()</code></p>
</li>
<li><p><code>InstallMultipleProtocolInterfaces()</code></p>
</li>
</ul>
<p>Services to retrieve protocols</p>
<ul>
<li><p><code>LocateProtocol()</code></p>
</li>
<li><p><code>OpenProtocol()</code></p>
</li>
</ul>
<p>First, to make use of it, the module writer must declare the protocols for the
module in the INF and then write code to use the protocols.</p>
<p>The following example demonstrates how a DXE driver produces a protocol:</p>
<pre><code class="lang-c"><span class="hljs-comment">//</span>
<span class="hljs-comment">// Handle for new protocol instance. Since it&apos;s NULL now, its value will</span>
<span class="hljs-comment">// be assigned by Boot Service InstallMultipleProtocolInterfaces()</span>
<span class="hljs-comment">//</span>
EFI_HANDLE mNewHandle = <span class="hljs-literal">NULL</span>;
<span class="hljs-comment">//</span>
<span class="hljs-comment">// The Sample Protocol instance produced by this driver</span>
<span class="hljs-comment">//</span>
EFI_SAMPLE_PROTOCOL mSampleProtocol = {
  SampleProtocolApi
  <span class="hljs-comment">//</span>
  <span class="hljs-comment">// More APIs can be added here</span>
  <span class="hljs-comment">//</span>
};
<span class="hljs-comment">//</span>
<span class="hljs-comment">// This is just a NULL function with no parameters. Necessary parameters</span>
<span class="hljs-comment">// and code can be added.</span>
<span class="hljs-comment">//</span>
<span class="hljs-function">EFI_STATUS
EFIAPI
<span class="hljs-title">SampleProtocolApi</span> <span class="hljs-params">(
   VOID
  )</span>
</span>{
  <span class="hljs-keyword">return</span> EFI_SUCCESS;
}
<span class="hljs-function">EFI_STATUS
EFIAPI
<span class="hljs-title">SampleDriverInitialize</span> <span class="hljs-params">(
  IN EFI_HANDLE        ImageHandle,
  IN EFI_SYSTEM_TABLE  *SystemTable
  )</span>
</span>{
  EFI_STATUS  Status;
  <span class="hljs-comment">//</span>
  <span class="hljs-comment">// More initialization can be added here.</span>
  <span class="hljs-comment">//</span>
  <span class="hljs-comment">//</span>
  <span class="hljs-comment">// Install the Sample Protocol onto a new handle</span>
  <span class="hljs-comment">//</span>
  Status = gBS-&gt;InstallMultipleProtocolInterfaces (
                  &amp;mNewHandle,
                  &amp;gEfiSampleProtocolGuid,
                  &amp;mSampleProtocol,
                  <span class="hljs-literal">NULL</span>
                  );
  ASSERT_EFI_ERROR (Status);
  <span class="hljs-keyword">return</span> EFI_SUCCESS;
}
</code></pre>
<p>The following example demonstrates how a DXE driver retrieves a protocol and
invokes the API:</p>
<pre><code class="lang-c"><span class="hljs-function">EFI_STATUS
<span class="hljs-title">SampleFunction</span> <span class="hljs-params">(
   VOID
  )</span>
</span>{
  EFI_STATUS           Status;
  EFI_SAMPLE_PROTOCOL  *SampleProtocol;
  <span class="hljs-comment">//</span>
  <span class="hljs-comment">// Locates the Sample Protocol from system.</span>
  <span class="hljs-comment">//</span>
  Status = gBS-&gt;LocateProtocol (
                  &amp;gEfiSampleProtocolGuid,
                  <span class="hljs-literal">NULL</span>,
                  (VOID **) &amp;SampleProtocol
                  );
  <span class="hljs-keyword">if</span> (EFI_ERROR (Status)) {
    <span class="hljs-keyword">return</span> Status;
  }
  Status = SampleProtocol-&gt;SampleProtocolApi();
  <span class="hljs-keyword">return</span> Status;
}
</code></pre>
<h3 id="842-variable">8.4.2 Variable</h3>
<p>Variables are defined as key/value pairs that consist of identifying
information plus attributes (the key) and arbitrary data (the value). Variables
are intended for use as a means to store data that is passed between the EFI
environment implemented in the platform and EFI OS loaders and other
applications that run in the EFI environment.</p>
<p>A DXE driver can read and write variables via the UEFI Runtime Services
<code>GetVariable()</code> and <code>SetVariable()</code>.</p>
<hr>
<p><strong>Note:</strong> These services are not available at the beginning of the DXE phase .
The PI Specification defines two architectural protocols to indicate the
readiness of read/write access to variables: <strong>EFIVARIABLE_ARCH_PROTOCOL</strong> and
<strong>EFI_VARIABLE_WRITE_ARCH_PROTOCOL.</strong>_</p>
<hr>
<p>DXE drivers that require read-only access or read/write access to volatile
environment variables must have <code>EFI_VARIABLE_ARCH_PROTOCOL</code> in their
dependency expressions.</p>
<p>DXE drivers that require write access to nonvolatile environment variables must
have the <code>EFI_VARIABLE_WRITE_ARCH_PROTOCOL</code> in their dependency expressions.</p>
<p>The full complement of environment variable services is not available until
both <code>EFI_VARIABLE_ARCH_PROTOCOL</code> and <code>EFI_VARIABLE_WRITE_ARCH_PROTOCOL</code> are
installed.</p>
<p>Sample code to read and write variables is as follows:</p>
<pre><code>EFI_STATUS
ReadAndWriteVariable (
    IN CHAR16 *Name,
    IN EFI_GUID *VendorGuid,
){
    EFI_STATUS Status;
    UINTN BufferSize;
    VOID *Buffer;
    Buffer = NULL;
    //
    // Pass in a zero-size buffer to find the required buffer size.
    //
    BufferSize = 0;
    Status = gRT-&gt;GetVariable (
                    Name,
                    VendorGuid,
                    NULL,
                    &amp;BufferSize,
                    Buffer
                    );
    //
    // If variable exists, the Status should be EFI_BUFFER_TOO_SMALL and
    // BufferSize has been updated.
    //
    if (Status != EFI_BUFFER_TOO_SMALL) {
    return Status;
    }
    //
    // Allocate the buffer according to updated BufferSize.
    //
    Buffer = AllocateZeroPool (BufferSize);
    ASSERT (Buffer != NULL);
    //
    // Read variable into the allocated buffer.
    //
    Status = gRT-&gt;GetVariable (
                    Name,
                    VendorGuid,
                    NULL,
                    &amp;BufferSize,
                    Buffer
                    );
    if (EFI_ERROR (Status)) {
    BufferSize = 0;
    }
    //
    // TODO: Process of retrieved variable can be added here.
    //
    //
    // Now write back the processed variable.
    //
    Status = gRT-&gt;SetVariable (
                    Name,
                    VendorGuid,
                    EFI_VARIABLE_BOOTSERVICE_ACCESS |
                    EFI_VARIABLE_RUNTIME_ACCESS |
                    EFI_VARIABLE_NON_VOLATILE,
                    BufferSize,
                    Buffer
                    );
    ASSERT_EFI_ERROR (Status);
    return EFI_SUCCESS;
}
</code></pre><h3 id="843-dynamic-pcd">8.4.3 Dynamic PCD</h3>
<p>EDK II provides dynamic PCDs as a high-level mechanism for communication
between modules. See Appendix A for details.</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="83_obtaining_services_tables.html#83-obtaining-services-tables" class="navigation navigation-prev " aria-label="Previous page: 8.3 Obtaining Services Tables">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="85_communication_with_peims.html#85-communication-with-peims" class="navigation navigation-next " aria-label="Next page: 8.5 Communication with PEIMs">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"8.4 Communication between DXE Drivers","level":"1.11.4","depth":2,"next":{"title":"8.5 Communication with PEIMs","level":"1.11.5","depth":2,"anchor":"#85-communication-with-peims","path":"8_dxe_drivers_non-uefi_drivers/85_communication_with_peims.md","ref":"8_dxe_drivers_non-uefi_drivers/85_communication_with_peims.md#85-communication-with-peims","articles":[]},"previous":{"title":"8.3 Obtaining Services Tables","level":"1.11.3","depth":2,"anchor":"#83-obtaining-services-tables","path":"8_dxe_drivers_non-uefi_drivers/83_obtaining_services_tables.md","ref":"8_dxe_drivers_non-uefi_drivers/83_obtaining_services_tables.md#83-obtaining-services-tables","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{"draft":"yes","title":"EDK II Module Writer's Guide","version":"Revision 0.71"},"plugins":["puml-aleung"],"pluginsConfig":{"puml-aleung":{},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css","website":"styles/website.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css","website":"styles/website.css"}},"file":{"path":"8_dxe_drivers_non-uefi_drivers/84_communication_between_dxe_drivers.md","mtime":"2025-04-30T21:34:45.839Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2025-04-30T21:35:13.856Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

